jQuery(document).ready(function(){let e=!1;function t(e){let t=$("#register_students_alert");t.prop("class","alert alert-danger"),"string"!=typeof e?t.text("Something went wrong while registering the students. Please try again."):t.text(e),t.prop("hidden",!1)}function s(){$("#register_students_modal").modal({backdrop:"",keyboard:!0}),$("#register_students_modal button[data-dismiss=modal]").each(function(){$(this).prop("disabled",!1)})}$("#register_students_modal").on("hidden.bs.modal",function(){e?window.location.replace(window.location.href):($("#students_file").val(""),$("#register_students_alert").prop("hidden",!0))}),$("#tab_students").append("<br><button class='btn btn-success' data-toggle='modal' data-target='#register_students_modal'><i class='fa fa-users'></i> Register students</button>"),$("form#upload_students_file").submit(function(a){a.preventDefault();let n=$("#students_file").prop("files")[0],i=$("#email_language").val();if(void 0===n)t("Please select a file before submitting it.");else if(/(\.csv)$/i.exec(n.name)){let a=new FormData;a.append("file",n),a.append("course",window.location.href.split("/")[4]),a.append("language",i),$.ajax({url:"/api/addStudents/",method:"POST",dataType:"json",data:a,mimeType:"multipart/form-data",processData:!1,contentType:!1,beforeSend:function(){$("#submit_register_students").prop("disabled",!0),$("#register_students_modal").modal({backdrop:"static",keyboard:!1}),$("#register_students_modal button[data-dismiss=modal]").each(function(){$(this).prop("disabled",!0)}),function(){let e=$("#register_students_alert");e.prop("class","alert alert-info"),e.text("Registering students..."),e.prop("hidden",!1)}()},success:function(a){!function(s){if("status"in s&&"error"===s.status)t(s.text);else if("status"in s&&"success"===s.status){const t=$("#register_students_alert");e=!0,$("#students_file").val(""),t.prop("class","alert alert-warning"),t.text(""),t.append($.parseHTML(s.text)),t.prop("hidden",!1),setTimeout(function(){t.prop("hidden",!0)},1e5)}else t("An error occurred while registering. Please try again.")}(a),s(),$("#submit_register_students").prop("disabled",!1)},error:function(e){t(e),s(),$("#submit_register_students").prop("disabled",!1)}})}else t("The inserted file should be a .csv file.")})});