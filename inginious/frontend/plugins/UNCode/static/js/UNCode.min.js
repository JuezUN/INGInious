const _this=this;jQuery(document).ready(function(){function t(t,a,n){jQuery.ajax({beforeSend:function(){$("#tab_file_list").html("Loading")},success:function(t){$("#tab_file_list").replaceWith(t),e(),n()},method:a,data:t,url:location.pathname+"/files"})}function e(){if(!$("#open_multiple_files_modal").length){const t=$("#tab_file_list > table > tbody tr"),e=t[t.length-1];if(e&&e.firstChild&&e.firstChild.nextSibling){const t=`<div class="align-right" id="task_files_options_buttons">${e.firstChild.nextSibling.innerHTML}</div><br>`;$("#tab_file_list > table").before(t),$("#task_files_options_buttons").append("<a href='#' class='btn btn-sm btn-info' data-toggle='modal' data-target='#task_files_upload_multiple_modal' id='open_multiple_files_modal'>Upload multiple files</a>"),$("#task_files_options_buttons").append("&nbsp;<button  type=\"button\" class='btn btn-sm btn-danger' data-toggle='modal' \n                data-target=\"#delete_all_files_confirm_modal\">Delete all files</button>"),e.remove()}}}_this.studio_update_file_tabs=((e,a)=>{null==e&&(e={}),null==a&&(a="GET"),t(e,a,()=>{})}),_this.studio_task_file_upload=(()=>{$("#modal_file_upload").modal("hide"),$("#task_upload_form").ajaxSubmit({beforeSend:function(){$("#tab_file_list").html("Loading")},success:function(t){$("#tab_file_list").replaceWith(t),e()},url:location.pathname+"/files"})}),e(),$("#upload_multiple_files_input").change(function(){let t=$(this).prop("files"),e=$("#list_all_files"),a=$.map(t,function(t){return t.name}).join(", ");t.length?(e.find("p[name=list_files]").text(a),e.prop("hidden",!1)):(e.find("p[name=list_files]").text(""),e.prop("hidden",!0))}),$("form#upload_multiple_files_form").submit(function(e){e.preventDefault();let a=!1,n=[],i=$("#upload_multiple_files_input").prop("files");i=$.extend({},i),$("#task_files_upload_multiple_modal").modal("hide"),i.length&&($("#tab_file_list").html("Uploading files..."),$.each(i,function(e,l){let o=new FormData;o.append("action","upload"),o.append("path",l.name),o.append("file",l),$.ajax({url:location.pathname+"/files",type:"post",data:o,contentType:!1,cache:!1,processData:!1,success:function(o){o.search(/alert/i)>0&&(a=!0,n.push(l.name)),e===i.length-1&&function(e,a){studio_update_file_tabs({},"GET");let n=()=>{};e&&(n=(()=>{!function(t){let e=$("#tab_file_list"),a=e.find("div").filter("[role=alert]");const n="<p>There was an error while uploading the files: <strong>"+t.sort().join(", ")+"</strong>. Invalid path, Maybe save the task or check that the name is not already in used. </p>";if(a.length)a.text(""),a.append(n);else{const t="<div class='alert alert-danger text-center' role='alert'>"+n+"</div>";e.prepend(t)}}(a)})),t({},"GET",n)}(a,n)}})}))}),$("#task_files_upload_multiple_modal").on("hidden.bs.modal",function(){$("#upload_multiple_files_input").val(""),$("#list_all_files").prop("hidden",!0)}),$("#edit_file_tabs").prepend('<div class="alert  alert-info">\n        <i class="fa fa-info-circle fa-lg" aria-hidden="true"></i>\n            <b>\n            If the files uploaded follow the format \'x.in\' and \'x.out\', those files will be automatically\n            matched as test cases (See the grader tab). \n            </b>\n        </div>'),$("#delete_all_files_btn").click(function(t){t.preventDefault();const e=$("#tab_file_list > table > tbody tr").filter((t,e)=>e.hasAttributes()&&e.attributes["data-x-path"]);let a="";e.each(function(t,e){const n=e.attributes["data-x-path"].value;"/run"!==n&&(studio_task_file_delete_tab(n)||(a+=`${n}, `),function(t){const e={action:"delete",path:t};jQuery.ajax({beforeSend:function(){$("#tab_file_list").html("Loading")},method:"GET",data:e,url:location.pathname+"/files"})}(n))}),studio_update_file_tabs({},"GET"),remove_all_test_cases()})}),jQuery(document).ready(function(){!function(){const t=window.location.origin+"/UNCode/static/images/LogotipoUNAL.png";!function(t){let e=$("#wrapper").find("> div.navbar.navbar-default.navbar-static-top > div > div.navbar-header > a");const a=e.find("> img").attr("src",t);e.text(""),e.html(a).append(" Code")}(t),function(t){$('link[rel="icon"]').attr("href",t)}(t),function(){let t=$("#footer");t.find("> div > div > div > p").html(" &copy; 2017-"+(new Date).getFullYear()+" Universidad Nacional de Colombia."),t.find("> div > div > div > div > p").html('<a target="_blank" href="https://github.com/JuezUN/INGInious" class="navbar-link">\nUNCode is distributed under AGPL license</a> - <a target="_blank" href="http://www.inginious.org" class="navbar-link">\nPowered by INGInious.\n</a>')}(),function(){let t=document.title.split("|");document.title=t[0]+" |  UNCode"}()}(),function(){let t=$(".CodeMirror");const e=$("#default_task_context").text();if(0!==$("#context").length&&0!==t.length){let a=t[0].CodeMirror;""===a.getDoc().getValue()&&a.getDoc().setValue(e)}}(),function(){let t=$("#context");0!==t.length&&t.before("<a href='#' type='button' data-toggle='modal' data-target='#task_context_help_modal'><i class='fa fa-question-circle'>  Help.</a>")}(),function(){let t=$('a[href="http://inginious.readthedocs.org/en/latest/teacher_doc/task_tuto.html"]');t.attr("href","https://github.com/JuezUN/INGInious/wiki/How-to-create-a-task"),t.attr("target","_blank");let e=$('a[href="http://inginious.readthedocs.org/en/latest/teacher_documentation.html"]');e.attr("href","https://github.com/JuezUN/INGInious/wiki/Course-administration"),e.attr("target","_blank")}(),$("#task_alert").before("<a href='#' type='button' data-toggle='modal' data-target='#task_result_legend_modal'><i class='fa fa-question-circle'>  Understand your task result.</a>"),$("#sidebar_affix").css("position","static"),$.ajax({url:"/api/getUsedSubproblemTypes/",type:"get",contentType:"application/json",dataType:"json",success:function(t){if(0!==t.length){let e=t;e=e.map(t=>"subproblem_"+t),$("#new_subproblem_type > option").each(function(t,a){let n=a.attributes[0].value;-1===e.indexOf(n)&&a.remove()})}}}),$.ajax({url:"/api/getUsedGradingEnvironments/",type:"get",contentType:"application/json",dataType:"json",success:function(t){if(0!==t.length){let e=t;$("form #environment > option").each(function(t,a){let n=a.attributes[0].value;-1===e.indexOf(n)&&a.remove()})}}}),function(){if(location.href.indexOf("/edit/task")>-1){let t=$("#main_container #content h2")[0].innerHTML,e=t.search('"')+1,a=t.substring(e).search('"'),n=$("#edit_task_tabs_content #name").val();""!==n&&($("#main_container #content h2")[0].innerHTML=t.substring(0,e)+n+t.substring(e+a))}}(),function(){const t=$(".alert-danger");if("/mycourses"===location.pathname&&t.length){const t='Failed to create the course. It might either already exist or contain an invalid character (only alphanumeric in addition to "_" and "-" are accepted).';$(".alert-danger")[0].childNodes[2].textContent=t}}()});