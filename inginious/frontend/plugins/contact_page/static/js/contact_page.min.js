class MessageBox{constructor(e,t,s,a=!0){this.divElement=document.getElementById(e),this.textContent=t,this.type=s,this.dismissible=a,this.generateHtmlCode(),this.displayBoxMessage()}generateHtmlCode(){let e='<div class="alert ';this.dismissible&&(e+="alert-dismissible "),e+=`alert-${this.type}" role="alert">`,this.dismissible||(e+='<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>'),e+=this.textContent+"</div>",this.code=e}displayBoxMessage(){this.divElement.innerHTML=this.code,this.divElement.style.display="block",this.dismissible&&this.doDisappearEffect()}doDisappearEffect(){let e=1;const t=this.divElement,s=setInterval(function(){e<=.1&&(t.style.display="none",clearInterval(s),t.innerHTML=""),t.style.opacity=e,t.style.filter="alpha(opacity="+100*e+")",e-=.05*e},100)}}const SELECT_ID="subject-selection",NO_SELECTED_ID="subject-no-selected",PROBLEM_OR_COMMENT_ID="subject-comment",NEW_COURSE_ID="subject-new-course",EMAIL_INPUT_ID="email-input",NAME_INPUT_ID="name-input",CHECKBOX_ID="checkbox-edit",COURSE_NAME_ID="course-name",COURSE_GROUP_ID="course-group",COURSE_NAME_SPACE_ID="course-space",TEXTAREA_ID="textarea-contact-page",SEND_BUTTON_ID="send-contact-page-button",COMMENTS_INSTRUCTIONS_ID="description-comment",NEW_COURSE_INSTRUCTIONS_ID="description-new-course",ALERT_SPACE_ID="alert-space",MODAL_SEND_ID="modalSendMessage",ALERT_MODAL_ID="alert-onmodal",TEXT_ALERT_ON_MODAL_SUCCESS_ID="text-alert-modal-success",TEXT_ALERT_ON_MODAL_FAIL_ID="text-alert-modal-fail",BUTTON_MORE_DETAILS="button-more-details",DETAILS_DIV="details",DETAILS_COLLAPSE="details-text",ERROR_TEXT="error";class ContactPageForm{constructor(){this.selectGroup=$(`#${SELECT_ID}`),this.emailInput=$(`#${EMAIL_INPUT_ID}`),this.nameInput=$(`#${NAME_INPUT_ID}`),this.editCheckbox=$(`#${CHECKBOX_ID}`),this.courseNameInput=$(`#${COURSE_NAME_ID}`),this.courseGroupInput=$(`#${COURSE_GROUP_ID}`),this.courseNameSpace=$(`#${COURSE_NAME_SPACE_ID}`),this.textarea=$(`#${TEXTAREA_ID}`),this.sendButton=$(`#${SEND_BUTTON_ID}`),this.commentInstructions=$(`#${COMMENTS_INSTRUCTIONS_ID}`),this.newCourseInstructions=$(`#${NEW_COURSE_INSTRUCTIONS_ID}`),this.modalSendMessage=$(`#${MODAL_SEND_ID}`),this.alertOnModal=$(`#${ALERT_MODAL_ID}`),this.textOnAlertSuccess=$(`#${TEXT_ALERT_ON_MODAL_SUCCESS_ID}`),this.textOnAlertFail=$(`#${TEXT_ALERT_ON_MODAL_FAIL_ID}`),this.buttonMoreDetails=$(`#${BUTTON_MORE_DETAILS}`),this.details=$(`#${DETAILS_DIV}`),this.errorText=$(`#${ERROR_TEXT}`),this.detailsText=$(`#${DETAILS_COLLAPSE}`),this.configForm(),this.addChangeListenerToSelect(),this.addChangeListenerToCheckbox(),this.addClickListenerToSendButton()}configForm(){this.hideAllSpecialSpaces(),this.showSpecialSpaces()}hideAllSpecialSpaces(){this.courseNameSpace.hide(),this.newCourseInstructions.hide(),this.commentInstructions.hide()}showSpecialSpaces(){switch(this.getOptionSelected()){case PROBLEM_OR_COMMENT_ID:this.commentInstructions.show();break;case NEW_COURSE_ID:this.courseNameSpace.show(),this.newCourseInstructions.show()}}addChangeListenerToSelect(){const e=this;this.selectGroup.change(function(){e.configForm()})}addChangeListenerToCheckbox(){const e=this;this.editCheckbox.change(function(){e.lockOrUnlockEmailAndNameInputF()})}addClickListenerToSendButton(){const e=this;this.sendButton.click(function(){e.sendInfo(),e.sendButton.prop("disabled",!0)})}addCloseListenerToOnCloseModal(){const e=this;this.modalSendMessage.on("hidden.bs.modal",function(){e.alertOnModal.is(".alert-success")&&(e.courseNameInput.val(""),e.courseGroupInput.val(""),e.textarea.val(""),e.alertOnModal.removeClass("alert-success"),e.textOnAlertSuccess.hide()),e.alertOnModal.is(".alert-danger")&&(e.alertOnModal.removeClass("alert-danger"),e.textOnAlertFail.hide(),e.errorText.text(""),e.details.hide(),e.detailsText.collapse("hide"))})}lockOrUnlockEmailAndNameInputF(){this.editCheckbox.is(":checked")?(this.emailInput.prop("disabled",!1),this.nameInput.prop("disabled",!1)):(this.emailInput.prop("disabled",!0),this.nameInput.prop("disabled",!0))}sendInfo(){this.validateFieldsStatus()?(this.sendRequest(),this.sendContactPageAnalytics()):new MessageBox(ALERT_SPACE_ID,"Correct all the errors noted in order to send the message ","danger",!1)}sendContactPageAnalytics(){jQuery.post("/api/analytics/",{service:{key:"contact_page",name:"Contact us"}})}validateFieldsStatus(){return this.removeErrorStyle(this.selectGroup),this.removeErrorStyle(this.emailInput),this.removeErrorStyle(this.nameInput),this.removeErrorStyle(this.textarea),this.checkSubjectIsOk()&this.checkEmailFieldIsOk()&this.checkNameFieldIsOk()&this.checkTextAreaIsOk()}sendRequest(){const e=this;jQuery.ajax({method:"POST",data:{subject_id:this.getOptionSelected(),email:this.emailInput.val(),name:this.nameInput.val(),courseName:this.courseNameInput.val(),courseGroup:this.courseGroupInput.val(),textarea:this.textarea.val()},success:function(t){e.alertOnModal.addClass("alert-success"),e.textOnAlertSuccess.show(),e.addCloseListenerToOnCloseModal(),e.modalSendMessage.modal("show")},error:function(t,s,a){e.alertOnModal.addClass("alert-danger"),e.textOnAlertFail.show(),e.addCloseListenerToOnCloseModal(),e.modalSendMessage.modal("show"),e.errorText.text(t.status+" "+a),e.details.show()}})}addErrorStyle(e,t){const s=e.parent();s.addClass("has-error"),s.append(`<span class="help-block">${t}</span>`)}removeErrorStyle(e){const t=e.parent();t.removeClass("has-error"),t.find("span").remove()}checkSubjectIsOk(){return!!this.checkSubjectIsSelected()||(this.addErrorStyle(this.selectGroup,"Select an option"),!1)}checkEmailFieldIsOk(){return this.checkInputContent(this.emailInput,0)?!!this.validateEmailFormat()||(this.addErrorStyle(this.emailInput,"An email is requested"),!1):(this.addErrorStyle(this.emailInput,"The email field is required"),!1)}checkNameFieldIsOk(){return!!this.checkInputContent(this.nameInput,0)||(this.addErrorStyle(this.nameInput,"The name field is required"),!1)}checkTextAreaIsOk(){return!!this.checkInputContent(this.textarea,21)||(this.addErrorStyle(this.textarea,"The comment is too short"),!1)}checkSubjectIsSelected(){return this.getOptionSelected()!==NO_SELECTED_ID}checkInputContent(e,t){return e.val().length>t}validateEmailFormat(){return/^[A-Z0-9._%+-]+@([A-Z0-9-]+\.)+[A-Z0-9._%+-]/i.test(this.emailInput.val())}getOptionSelected(){return $(`#${SELECT_ID} option:selected`).attr("id")}changeSelection(e=NO_SELECTED_ID){$(`#${e}`).attr("selected","selected")}}jQuery(document).ready(function(){(new ContactPageForm).changeSelection()});