const RESPONSE_FIELD_ID="gradeEditSubmitStatus",FEEDBACK_FIELD_ID="taskAlert",TASK_NAME="taskName",TASK_DESCRIPTION_TEXT_ID="taskDescription",CODE_AREA_ID="codemirrorTextArea",NOTEBOOK_CODE_AREA_ID="notebookHolder",GRADE_ID="grade";function loadFeedBack(e){const t=getHtmlCodeForFeedback(),s=getTextBoxTypeBasedOnResult();new MessageBox(e,t,s,!1).deleteCloseButton()}function addToggleBehaviorToProblemDescription(e,t){$(`#${e}`).click(function(){$(`#${t}`).collapse("toggle")})}const LANGUAGES={java7:"java",java8:"java",cpp:"cpp",cpp11:"cpp",c:"c",c11:"c",python3:"python",vhdl:"vhdl",verilog:"verilog",rst:"rst"};class CodeArea{constructor(e,t=null,s=""){this.environmentType=s,this.multilangCodeArea=$(`#${e}`),this.codeMirror=null,t&&(this.notebookDiv=$(`#${t}`))}displayCodeArea(){this.isNotebook()?this.getNotebookCodeDataAndRender():(this.showMultiLangCodeArea(),this.disabledCodeMirrorEdit())}isNotebook(){return"Notebook"===this.environmentType}getNotebookCodeDataAndRender(){const e=this;$.ajax({url:getURLSubmissionCode(),method:"GET",dataType:"json",success:function(t){render_notebook(t,e.notebookDiv)}})}showMultiLangCodeArea(){this.multilangCodeArea.parent().show();const e=LANGUAGES[this.multilangCodeArea.data("language")];this.codeMirror=registerCodeEditor(this.multilangCodeArea.get(0),e,20)}disabledCodeMirrorEdit(){this.codeMirror.setOption("readOnly","nocursor")}}class MessageBox{constructor(e,t,s,i=!0){this.divElement=document.getElementById(e),this.textContent=t,this.type=s,this.dismissible=i,this.generateHtmlCode(),this.displayBoxMessage()}generateHtmlCode(){let e='<div class="alert ';this.dismissible&&(e+="alert-dismissible "),e+=`alert-${this.type}" role="alert">`,this.dismissible||(e+='<button id=\'close-b\' type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>'),e+=this.textContent+"</div>",this.code=e}displayBoxMessage(){this.divElement.innerHTML+=this.code,this.divElement.style.display="block",this.dismissible&&this.doDisappearEffect()}doDisappearEffect(){let e=1;const t=this.divElement,s=setInterval(function(){e<=.1&&(t.style.display="none",clearInterval(s),t.innerHTML=""),t.style.opacity=e,t.style.filter="alpha(opacity="+100*e+")",e-=.05*e},100)}deleteCloseButton(){document.getElementById("close-b").remove()}}class Rubric{constructor(){this.score=0,this.matrix=[],this.matrixLength=5,this.classMarkerId="box1",this.scoreTextId="output",this.formMatrixRespectRubric()}formMatrixRespectRubric(){for(let e=0;e<this.matrixLength;e++){this.matrix[e]=[];for(let t=0;t<this.matrixLength;t++){let s=new MatrixField(e,t);this.matrix[e][t]=document.getElementById(s.fieldId)}}}makeRubricInteractive(){for(let e=0;e<this.matrixLength;e++)for(let t=0;t<this.matrixLength;t++){let s=new MatrixField(e,t);this.addSelectFunction(s),this.addDeselectFunction(s),this.changeCursorToPointerWhenIsOver(s),this.changeCursorToDefaultWhenIsOut(s)}}addSelectFunction(e){const t=this;this.matrix[e.iIndex][e.jIndex].addEventListener("click",function(){t.removeSelectionOnRow(e.iIndex),t.addMarkerClass(e.fieldId),t.updateScore(e.jIndex)})}addDeselectFunction(e){const t=this;this.matrix[e.iIndex][e.jIndex].addEventListener("dblclick",function(){t.removeMarkerClass(e.fieldId),t.updateScore(e.jIndex,!1)})}changeCursorToPointerWhenIsOver(e){this.matrix[e.iIndex][e.jIndex].addEventListener("mouseover",function(){document.body.style.cursor="pointer"})}changeCursorToDefaultWhenIsOut(e){this.matrix[e.iIndex][e.jIndex].addEventListener("mouseout",function(){document.body.style.cursor="default"})}removeSelectionOnRow(e){let t=this.getSelectionOnRow(e);null!==t&&(this.removeMarkerClass(t.fieldId),this.updateScore(t.jIndex,!1))}getSelectionOnRow(e){for(let t=0;t<this.matrixLength;t++){let s=new MatrixField(e,t);if(this.isFieldSelected(s))return s}return null}addMarkerClass(e){document.getElementById(e).classList.add(this.classMarkerId)}removeMarkerClass(e){document.getElementById(e).classList.remove(this.classMarkerId)}isFieldSelected(e){return this.matrix[e.iIndex][e.jIndex].classList.contains(this.classMarkerId)}updateScoreText(){const e=new Score(this.scoreTextId,this.score);e.changeColor(),e.updateScore()}updateScore(e,t=!0){t?this.score+=.2*(e+1):this.score-=.2*(e+1),this.updateScoreText()}getSelectedFieldIds(){let e=[];for(let t=0;t<this.matrixLength;t++){let s=this.getSelectionOnRow(t);null!==s&&e.push(s.fieldId)}return e}loadSelectedFields(e){const t=this;e.forEach(function(e){t.addMarkerClass(e),t.updateScore(parseInt(e[2],10))})}}class MatrixField{constructor(e,t){this.iIndex=e,this.jIndex=t}get fieldId(){return`${this.iIndex}-${this.jIndex}`}}class Score{constructor(e,t){this.text=$(`#${e}`),this.score=t}changeColor(){const e=this.pickColor(this.score);this.text.css("color",e)}updateScore(){let e;e=parseFloat(this.score).toFixed(1),isNaN(e)&&(e=this.score),this.text.html(e)}pickColor(e){return{0:"#950000",1:"#cc0808",2:"#e73509",3:"#ff7903",4:"#ffb700",5:"#ffc800",6:"#bfc604",7:"#a5d424",8:"#67a00c",9:"#2d8e00",10:"#008e02",defaultColor:"#002a95"}[this.scoreToDictId(e)]}scoreToDictId(e){let t;return t=parseFloat(e),isNaN(t)?"defaultColor":Math.floor(2*t)}}