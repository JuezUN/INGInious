const RESPONSE_FIELD_ID="gradeEditSubmitStatus",FEEDBACK_FIELD_ID="taskAlert",TASK_NAME="taskName",TASK_DESCRIPTION_TEXT_ID="taskDescription",CODE_AREA_ID="codemirrorTextArea",NOTEBOOK_CODE_AREA_ID="notebookHolder",FILE_MULTI_LANG_ID="downloadMultiLang",GRADE_ID="grade";function loadFeedBack(e){const t=getTextBoxTypeBasedOnResult(),i=$(`#${e}`);jQuery.post(getURLSubmissionInput(),{"@action":"load_submission_input",submissionid:getCurrentSubmissionId()},null,"json").done(function(e){i.html(getAlertCode(e.text,t,!1))})}function addToggleBehaviorToProblemDescription(e,t){$(`#${e}`).click(function(){$(`#${t}`).collapse("toggle")})}const LANGUAGES={java7:"java",java8:"java",cpp:"cpp",cpp11:"cpp",c:"c",c11:"c",python3:"python",vhdl:"vhdl",verilog:"verilog",rst:"rst"},environmentTypes={NOTEBOOK:"notebook_file",FILE_MULTI_LANG:"code_file_multiple_languages",MULTI_LANG:"code_multiple_languages"};class CodeArea{constructor(e){this.environmentType=e,this.multilangCodeArea=$(`#${CODE_AREA_ID}`),this.notebookDiv=$(`#${NOTEBOOK_CODE_AREA_ID}`),this.fileDownloadArea=$(`#${FILE_MULTI_LANG_ID}`),this.codeMirror=null}displayCodeArea(){switch(this.environmentType){case environmentTypes.NOTEBOOK:this.getNotebookCodeDataAndRender();break;case environmentTypes.FILE_MULTI_LANG:this.showDownloadArea();break;case environmentTypes.MULTI_LANG:this.showMultiLangCodeArea(),this.disabledCodeMirrorEdit();break;default:this.multilangCodeArea=$(`#${this.environmentType}`),this.showMultiLangCodeArea()}}getNotebookCodeDataAndRender(){const e=this;$.ajax({url:getURLSubmissionCode(),method:"GET",dataType:"json",success:function(t){render_notebook(t,e.notebookDiv)}})}showMultiLangCodeArea(){this.multilangCodeArea.parent().show();const e=LANGUAGES[this.multilangCodeArea.data("language")];this.codeMirror=registerCodeEditor(this.multilangCodeArea.get(0),e,20)}disabledCodeMirrorEdit(){this.codeMirror.setOption("readOnly","nocursor")}showDownloadArea(){this.fileDownloadArea.parent().parent().show(),this.fileDownloadArea.attr("href",getURLSubmissionCode())}}class Rubric{constructor(){this.score=0,this.matrix=[],this.matrixHeight=getRubricHeight(),this.matrixWidth=getRubricWidth(),this.classMarkerId="box1",this.scoreTextId="output",this.formMatrixRespectRubric()}formMatrixRespectRubric(){for(let e=0;e<this.matrixHeight;e++){this.matrix[e]=[];for(let t=0;t<this.matrixWidth;t++){let i=new MatrixField(e,t);this.matrix[e][t]=document.getElementById(i.fieldId)}}}makeRubricInteractive(){for(let e=0;e<this.matrixHeight;e++)for(let t=0;t<this.matrixWidth;t++){let i=new MatrixField(e,t);this.addSelectFunction(i),this.changeCursorToPointerWhenIsOver(i),this.changeCursorToDefaultWhenIsOut(i)}}addSelectFunction(e){const t=this;this.matrix[e.iIndex][e.jIndex].addEventListener("click",function(){const i=t.isSelected(e);t.removeSelectionOnRow(e.iIndex),i||(t.addMarkerClass(e.fieldId),t.updateScore(e.jIndex))})}isSelected(e){const t=this.getSelectionOnRow(e.iIndex);return!!t&&t.fieldId===e.fieldId}changeCursorToPointerWhenIsOver(e){this.matrix[e.iIndex][e.jIndex].addEventListener("mouseover",function(){document.body.style.cursor="pointer"})}changeCursorToDefaultWhenIsOut(e){this.matrix[e.iIndex][e.jIndex].addEventListener("mouseout",function(){document.body.style.cursor="default"})}removeSelectionOnRow(e){let t=this.getSelectionOnRow(e);null!==t&&(this.removeMarkerClass(t.fieldId),this.updateScore(t.jIndex,!1))}getSelectionOnRow(e){for(let t=0;t<this.matrixWidth;t++){let i=new MatrixField(e,t);if(this.isFieldSelected(i))return i}return null}addMarkerClass(e){document.getElementById(e).classList.add(this.classMarkerId)}removeMarkerClass(e){document.getElementById(e).classList.remove(this.classMarkerId)}isFieldSelected(e){return this.matrix[e.iIndex][e.jIndex].classList.contains(this.classMarkerId)}updateScoreText(){const e=new Score(this.scoreTextId,this.score);e.changeColor(),e.updateScore()}updateScore(e,t=!0){const i=5*(e+1)*(1/this.matrixHeight)/this.matrixWidth;t?this.score+=i:this.score-=i,this.updateScoreText()}getSelectedFieldIds(){let e=[];for(let t=0;t<this.matrixHeight;t++){let i=this.getSelectionOnRow(t);null!==i&&e.push(i.fieldId)}return e}loadSelectedFields(e){const t=this;e.forEach(function(e){t.addMarkerClass(e),t.updateScore(parseInt(e[2],10))})}}class MatrixField{constructor(e,t){this.iIndex=e,this.jIndex=t}get fieldId(){return`${this.iIndex}-${this.jIndex}`}}class Score{constructor(e,t){this.text=$(`#${e}`),this.score=t}changeColor(){const e=this.pickColor(this.score);this.text.css("color",e)}updateScore(){let e;e=parseFloat(this.score).toFixed(1),isNaN(e)&&(e=this.score),this.text.html(e)}pickColor(e){return{0:"#950000",1:"#cc0808",2:"#e73509",3:"#ff7903",4:"#ffb700",5:"#ffc800",6:"#bfc604",7:"#a5d424",8:"#67a00c",9:"#2d8e00",10:"#008e02",defaultColor:"#002a95"}[this.scoreToDictId(e)]}scoreToDictId(e){let t;return t=parseFloat(e),isNaN(t)?"defaultColor":Math.floor(2*t)}}